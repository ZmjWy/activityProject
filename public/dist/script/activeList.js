$(function(){function n(n){var t;n.map(function(n,o){t='<tr class="clearFix">\n                            <td>\n                                <p>\n'+n.nickName+"                                </p>\n                            </td>\n                            <td>\n                                <p>\n"+n.todayGold+"                                </p>\n                            </td>\n                            <td>\n                                <p>"+n.allGold+"</p>\n                            </td>\n                        </tr>",$("#romanceActive").append(t)})}function t(n){var t,o="";n.map(function(n,a){o=0==n.wakeAlready?'<p class="option-prompt">提醒Ta</p>':'<p class="option-prompt-style">已提醒</p>',t='<tr class="trNum clearFix">\n                            <td>\n                                <p>\n'+n.nickName+"                                </p>\n                            </td>\n                            <td>\n                                <p>"+n.loginDate+"</p>\n                            </td>\n                            <td>\n"+o+'                                <div class="talk-modal-box" style="display: none;">\n                                    <div class="talk-modal">\n                                        <div class="clearFix">\n                                            <a href="javascript:void(0);" class="remind-dx" data-dx="'+n.uid+'">\n                                                <img src="http://file.xcmad.com/dist/images/friend-m-dx_03.jpg" alt="">\n                                                <p>短信提醒</p>\n                                            </a>\n                                            <span></span>\n                                            <a href="friend://wx='+n.uid+'" class="remind-wx">\n                                                <img src="http://file.xcmad.com/dist/images/friend-m-wx_03.jpg" alt="">\n                                                <p>微信提醒</p>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </td>\n                        </tr>',$("#inviteFriends").append(t)}),$(".option-prompt").on("click",function(){$(this).next().show(),$(".modal-close").show(),m=$(this).parents("tr").index()}),$(".remind-dx").on("click",function(){var n=$(this).attr("data-dx");a(n)}),$(".remind-wx").on("click",function(){var n=$(this);$(".modal-close").hide(),$(".talk-modal-box").hide(),setTimeout(function(){n.parents(".talk-modal-box").prev().addClass("option-prompt-style").text("已提醒").unbind("click")},5e3)})}function o(n){var t,o="";n.map(function(n,a){o=0==n.wakeAlready?'<p class="option-prompt">提醒Ta</p>':'<p class="option-prompt-style">已提醒</p>',t='<tr class="trNum clearFix">\n                            <td>\n                                <p>\n'+n.nickName+"                                </p>\n                            </td>\n                            <td>\n                                <p>"+n.loginDate+"</p>\n                            </td>\n                            <td>\n                                <p>"+n.allGold+"</p>\n                            </td>\n                            <td>\n"+o+'                                <div class="talk-modal-box" style="display: none;">\n                                    <div class="talk-modal">\n                                        <div class="clearFix">\n                                            <a href="javascript:void(0);" class="remind-dx" data-dx="'+n.uid+'">\n                                                <img src="http://file.xcmad.com/dist/images/friend-m-dx_03.jpg" alt="">\n                                                <p>短信提醒</p>\n                                            </a>\n                                            <span></span>\n                                            <a href="friend://wx='+n.uid+'" class="remind-wx">\n                                                <img src="http://file.xcmad.com/dist/images/friend-m-wx_03.jpg" alt="">\n                                                <p>微信提醒</p>\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </td>\n                        </tr>',$("#inaction").append(t)}),$(".option-prompt").on("click",function(){$(this).next().show(),$(".modal-close").show(),m=$(this).parents("tr").index()}),$(".remind-dx").on("click",function(){var n=$(this).attr("data-dx");a(n)}),$(".remind-wx").on("click",function(){var n=$(this);$(".modal-close").hide(),$(".talk-modal-box").hide(),setTimeout(function(){n.parents(".talk-modal-box").prev().addClass("option-prompt-style").text("已提醒").unbind("click")},5e3)})}function a(n){$.ajax({url:ctxs+"/act/h5/wakeFriendStatus?tel_num="+l.tel_num,type:"GET",dataType:"jsonp",jsonp:"callback",jsonpCallback:"send",success:function(t){0==t.status?e(n,"限时免费",'，活动期间<span style="color: #fe233e;">免费</span>发短信',"免费短信唤醒好友"):1==t.status?e(n,"唤醒好友得金币","","花费400金币发短信"):202==t.status?toast("请勿重复操作"):toast(t.status)},error:function(n){console.log(n)}})}function e(n,t,o,a){window.createModal.showCustom(t,"0.36rem",'<span style="color: #9a9a9a;font-size: 0.3rem;display: block;width: 4.78rem;text-align: left;margin: 0 auto 0.2rem;">花400金币唤醒好友（系统代发短信）\n好友重新使用花生头条并签到一次，\n您将获得<span style="color: #fe233e;">3000金币</span>奖励'+o+"。</span>","",'<span style="font-size: 0.44rem;">'+a+"</span>",function(){$.ajax({url:ctxs+"/act/h5/wakeFriend?tel_num="+l.tel_num+"&friendUid="+n+"&type=1",type:"GET",dataType:"jsonp",jsonp:"callback",jsonpCallback:"wake",success:function(n){0==n.status?(toast("短信发送成功"),$(".trNum").eq(m).find(".option-prompt").addClass("option-prompt-style").text("已提醒").unbind("click")):toast(n.msg)},error:function(n){consoloe.log(n)}}),$(".modal-close").hide(),$(".talk-modal-box").hide()})}function i(a,e,i){$.ajax({url:ctxs+"/act/sp/h5/friendListSpring?tel_num="+l.tel_num+"&isActive="+e+"&page="+i,type:"GET",dataType:"jsonp",jsonp:"callback",jsonpCallback:"friendList"+Math.random().toString().substr(2),success:function(i){console.log(i),0==i.status?(c&&($("#friendCount").text(i.response.invitive_friendCount),$("#todayGold").text(i.response.effective_friendCount)),c=!1,i.response.list.length>0?(1==e?($("#info-active").hide(),$(".info-active").show(),n(i.response.list)):2==e?($("#info-awaken").hide(),$(".info-awaken").show(),t(i.response.list)):($("#inaction-awaken").hide(),$(".inaction-awaken").show(),o(i.response.list)),""!==a&&a.resetload()):""!==a&&(a.noData(!0),a.resetload())):""!==a&&a.resetload()},error:function(n){""!==a&&a.resetload()}})}function s(n,t,o){$.ajax({url:ctxs+"/act/h5/friendList?tel_num="+l.tel_num+"&isActive="+t+"&page="+o,type:"GET",dataType:"jsonp",jsonp:"callback",jsonpCallback:"getAllNum",success:function(n){console.log(n),0==n.status&&$("#allGold").text(n.response.allGold)},error:function(n){}})}var l=new GetQueryString,d=null,c=!0,r=1,p=1,m=0;$(".option-items").on("click",function(){clearTimeout(d);var n=$(this).index();$(".info-show").eq(n).show().siblings().hide(),$(this).css("color","#ff5337").siblings().css("color","#000"),r=1,0==n?($("#romanceActive").children().remove(),$("#option-speed").css("left","0%"),p=1):1==n?($("#romanceAwaken").children().remove(),$("#option-speed").css("left","33.3333%"),p=2):($("#option-speed").css("left","66.6666%"),$("#inaction").children().remove(),p=0),u.resetload(),d=setTimeout(function(){i("",p,r)},1e3)}),$(".modal-close").on("click",function(){$(this).hide(),$(".talk-modal-box").hide()}),s("",1,r),i("",1,r);var u=$(".friend-container").dropload({scrollArea:window,distance:30,autoLoad:!1,domDown:{domClass:"dropload-down",domRefresh:'<div class="dropload-load" style="display: none;"><span class="loading"></span></div>',domLoad:'<div class="dropload-load"><span class="loading"></span>加载中...</div>',domNoData:'<div class="dropload-noData">暂无数据</div>'},scrollRange:function(n){},loadDownFn:function(n){clearTimeout(d),d=setTimeout(function(){r++,i(n,p,r)},1e3)}});$(".invitation-friend").on("click",function(){$(".invitation-shortcut-share").show()}),$(".invitation-shortcut-share").on("click",function(){$(this).hide()})});