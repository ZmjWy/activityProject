$(function(){function e(e,t){androidObj.callBack(androidObj.addUrl({device:e,wxName:i.wx_name,type:t,image:"http://file.xcmad.com/dist/images/turn-share.jpg",url:"/activePage/lottery.html?tel_num="+a.tel_num+"&local_ip="+i.local_ip.replace(/[^0-9]/g,""),share:i.shareToday}))}function t(){$.ajax({type:"GET",url:ctxs+"/turntable/h5/getTimes?tel_num="+a.tel_num,dataType:"jsonp",jsonp:"callback",jsonpCallback:"rewardNum",success:function(e){if(100==e.status&&($("#degree").text(e.num),$(".record-list-show").children().remove(),i.num=e.num,i.useNum=e.use_num,i.shareToday=e.share_today,e.list&&e.list.length>0)){$(".no-record").hide(),$(".record-list-show").show();var t="";e.list.map(function(e,n){t+='<li class="clearFix"><p>'+e.reward_num+"金币</p><p>"+new Date(e.creation_date).Format("yyyy/MM/dd hh:mm:ss").replace(/\s/g,"<br/>")+"</p><p>已发放</p></li>"}),$(".record-list-show").append(t)}},error:function(e){}})}function n(){$.ajax({type:"GET",url:ctxs+"/turntable/h5/whoget",dataType:"jsonp",jsonp:"callback",jsonpCallback:"whoget",success:function(e){var t="";e.get_list&&e.get_list.length>0&&(e.get_list.map(function(e,n){t+="<li>"+e+"</li>"}),$("#record-animate").append(t),setInterval(o,2500))},error:function(e){}})}function o(){$("#record-animate").animate({marginTop:"-0.58rem"},1e3,function(){$(this).css({marginTop:0}),$(this).children().eq(0).appendTo($(this))})}function r(t,n){var o=null,r=0;clearInterval(o),o=setInterval(function(){Math.floor(r/360)<3?r=.5*n*3600+t:(0!=s?d.style.transform="rotate("+(r+360)+"deg)":d.style.transform="rotate("+r+"deg)",clearInterval(o),setTimeout(function(){u=!u,s=r%360,s<=1*l?window.createTurntable("getMoney",{href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"100金币",title:"恭喜获得"}):s<=2*l?window.createTurntable("getMoney",{href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"5万金币",title:"恭喜获得"}):s<=3*l?window.createTurntable("getMoney",{href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"50金币",title:"恭喜获得"}):s<=4*l?window.createTurntable("activeEnd",{img:0,width:1.7,href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"今日奖品已领光<br/>送您300金币<br/>明天早点来吧"}):s<=5*l?window.createTurntable("getMoney",{href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"300金币",title:"恭喜获得"}):s<=6*l?window.createTurntable("getMoney",{href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"50000金币",title:"恭喜获得"}):s<=7*l?window.createTurntable("getMoney",{href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"50金币",title:"恭喜获得"}):s<=8*l&&window.createTurntable("activeEnd",{img:0,width:1.7,href:function(){e("wx",androidObj.shareFriend)},text:"分享再抽一次",content:"今日奖品已领光<br/>送您300金币<br/>明天早点来吧"})},4e3))},30)}var a=new GetQueryString,i={num:0,shareToday:!0,useNum:0,tel_num:"",wx_name:"",local_ip:""};androidObj.callBack(androidObj.getUserInfos),androidObj.callBack(androidObj.getDeviceInfos),window.onReceiveMessage=function(e){var n=JSON.parse(e),o=n.path;androidObj.shareCall.map(function(e,r){e.url==o&&("shareTerrace"==e.back?androidObj[e.back](t):androidObj[e.back](n,i))})},$("#turntable-friend").on("click",function(){e("wx",androidObj.shareFriend)}),$("#turntable-wxShare").on("click",function(){e("wx",androidObj.shareWx)}),$("#turntable-qqZoneShare").on("click",function(){e("qq",androidObj.shareQq)}),$("#turntable-qqShare").on("click",function(){e("qq",androidObj.shareZone)}),t(),n();var c=document.getElementById("turntable-pointer"),d=document.getElementById("turntable-double"),l=45,s=0,u=!0,m=[22,67,112,157,202,247,292,337,382],h=0;c.onclick=function(){i.num>0?$.ajax({type:"GET",url:ctxs+"/turntable/h5/useTimes?tel_num="+a.tel_num,dataType:"jsonp",jsonp:"callback",jsonpCallback:"reward",success:function(e){100==e.status?u&&(h++,u=!u,r(m[e.type],h),t()):toast(e.msg)},error:function(e){console.log(e)}}):i.useNum<5?window.createTurntable("activeEnd",{img:1,width:2.3,href:function(){e("wx",androidObj.shareFriend)},text:"分享抽奖",content:"邀请好友参加活动<br/>可获得抽奖机会"}):window.createTurntable("activeEnd",{img:0,width:1.7,href:function(){e("wx",androidObj.shareFriend)},text:"查看更多赚金币方法",content:"今日抽奖机会已用完<br>明天继续吧"})},$("#scroll-rule").on("click",function(){var e=$(".turntable-record").offset().top;$("html, body").animate({scrollTop:e+"px"},800)}),$(".rule-btn").on("click",function(){var e=$(".turntable-rule").offset().top;$("html, body").animate({scrollTop:e+"px"},800)})}),function($){function e(){}function t(t,n){var o=new e;o[t](n)}e.prototype.mBox=$('<div class="modal-box" style="display: block;position: fixed;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.5);z-index: 999;top: 0;left: auto;"></div>'),e.prototype.sBox=$('<div class="modal-content" style="position: relative;width: 100%;height: 100%;display: flex;align-items: center;justify-content: center;"></div>'),e.prototype.content=$('<div style="width: 4.8rem;height: 5.08rem;background: url(http://file.xcmad.com/dist/images/turntable-modal-bg_03.png) no-repeat scroll top center/100%;position: relative;"></div>'),e.prototype.close=$('<img src="http://file.xcmad.com/dist/images/turntable-modal-close_03.png" style="position: absolute;width: 0.28rem;top:0.3rem;right: 0.42rem;">'),e.prototype.addMode=function(e){var t=this;this.content.html(""),this.content.append(e),this.content.append(this.close),this.sBox.append(this.content),this.mBox.append(this.sBox),$("body").append(this.mBox),this.close.on("click",function(){t.mBox.remove()})},e.prototype.activeEnd=function(e){var t=this,n=["http://file.xcmad.com/dist/images/turntable-modal-2_03.png","http://file.xcmad.com/dist/images/turntable-modal-1_03.png"],o=$('<div><img src="'+n[e.img]+'" style="width: '+e.width+'rem;display: block;margin: 0.3rem auto 0;" alt=""><div style="display: flex;justify-content: center;align-items: center;width: 100%;height: 2rem;"><p style="font-size: 0.38rem;color: #c77a30;text-align: center;">'+e.content+'</p></div><a class="share" href="javascript:void(0);" style="display: block;padding: 0 0.26rem;line-height: 0.68rem;height: 0.68rem;border-radius: 0.68rem;background: #fdba0d;color: #fff;font-size: 0.3rem;text-align: center;max-width: 3.22rem;text-decoration: none;margin: 0 auto;">'+e.text+"</a></div>");this.addMode(o),$(".share").on("click",function(){e.href(),t.mBox.remove()})},e.prototype.getMoney=function(e){var t=this,n=$('<div><div style="padding: 0.7rem 0 0;"><p style="font-size: 0.38rem;color: #c77a30;text-align: center;padding-bottom: 0.1rem;">'+e.title+'</p><p style="font-size: 0.52rem;color: #c77a30;text-align: center;font-weight: 800;">'+e.content+'</p></div><img src="http://file.xcmad.com/dist/images/turntable-modal-3_03.png" style="width:1.28rem;display: block;margin: 0.2rem auto 0.3rem;" alt=""><a class="share" href="javascript:void(0);" style="display: block;padding: 0 0.26rem;line-height: 0.68rem;height: 0.68rem;border-radius: 0.68rem;background: #fdba0d;color: #fff;font-size: 0.3rem;text-align: center;max-width: 3.22rem;text-decoration: none;margin: 0 auto;">'+e.text+"</a></div>");this.addMode(n),$(".share").on("click",function(){e.href(),t.mBox.remove()})},window.createTurntable=t}(window.Zepto||window.jQuery);